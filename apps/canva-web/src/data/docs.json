[
  {
    "id": "1",
    "slug": "getting-started",
    "title": "Getting Started",
    "category": "Introduction",
    "description": "Initial setup guide for the Canva Clone project from a zip file",
    "content": "# Getting Started\n\nThis guide will help you set up the Canva Clone project from a zip file.\n\n## Prerequisites\n\nBefore you begin, ensure you have the following installed:\n\n- **Node.js**: Version 20.x (required)\n- **pnpm**: Package manager (install with `npm install -g pnpm`)\n- **PostgreSQL**: Database server (version 12 or higher)\n- **Git**: Version control (optional but recommended)\n\n## Extracting the Project\n\n1. Extract the zip file to your desired location\n2. Open a terminal and navigate to the extracted folder:\n   ```bash\n   cd canva-clone\n   ```\n\n## Project Structure\n\nThis project consists of two main applications:\n\n- **canva-web**: Next.js frontend application (part of Nx monorepo)\n- **canva-admin**: Strapi CMS backend (standalone application)\n\n## Next Steps\n\n1. Read about [React Version Mismatch](react-version-mismatch) to understand the different React versions\n2. Follow the [Web Setup Guide](canva-web-setup) for the frontend\n3. Follow the [Admin Setup Guide](canva-admin-setup) for the backend\n4. Configure [Environment Variables](environment-variables)\n5. **Before deploying**: Push your project to GitHub (required for Railway and Vercel)\n6. For production deployment:\n   - [Deploy Admin on Railway](deploy-admin-railway) - includes GitHub setup instructions\n   - [Deploy Web on Vercel](deploy-web-vercel) - includes GitHub setup instructions\n7. Check [Troubleshooting](troubleshooting) if you encounter issues",
    "updatedAt": "2025-01-20T10:00:00Z"
  },
  {
    "id": "2",
    "slug": "react-version-mismatch",
    "title": "React Version Mismatch Explained",
    "category": "Introduction",
    "description": "Understanding why canva-admin uses React 18 and canva-web uses React 19",
    "content": "# React Version Mismatch Explained\n\nThis project uses different React versions for different applications. This is intentional and here's why:\n\n## Version Differences\n\n### Canva-Web (React 19)\n\n- **Version**: React 19.2.0\n- **Location**: `apps/canva-web`\n- **Reason**: Next.js 16 requires React 19 for optimal performance and latest features\n- **Managed by**: Nx monorepo with pnpm overrides\n\n### Canva-Admin (React 18)\n\n- **Version**: React 18.3.1\n- **Location**: `apps/canva-admin`\n- **Reason**: Strapi 5.31.2 is built on React 18 and doesn't support React 19 yet\n- **Managed by**: Strapi's internal dependencies\n\n## Why This Works\n\nEach application runs independently:\n\n- **canva-web** is a Next.js app that runs on port 3001\n- **canva-admin** is a Strapi app that runs on port 1337\n- They communicate via REST API, not shared React components\n- Each has its own `node_modules` with isolated dependencies\n\n## Important Notes\n\n- ✅ This is **normal** and **expected** behavior\n- ✅ No conflicts occur because apps are isolated\n- ✅ Don't try to force React 19 in canva-admin (Strapi won't work)\n- ✅ Don't downgrade React in canva-web (Next.js 16 requires React 19)\n\n## Package Manager Configuration\n\nThe root `package.json` includes pnpm overrides to ensure React 19 for the monorepo:\n\n```json\n\"pnpm\": {\n  \"overrides\": {\n    \"react\": \"^19.2.0\",\n    \"react-dom\": \"^19.2.0\"\n  }\n}\n```\n\nThis only affects monorepo apps (canva-web), not the standalone canva-admin.",
    "updatedAt": "2025-01-20T10:00:00Z"
  },
  {
    "id": "3",
    "slug": "canva-web-setup",
    "title": "Setting Up Web",
    "category": "Setup",
    "description": "Step-by-step guide to set up the Next.js frontend application",
    "content": "# Setting Up Web\n\nCanva-Web is a Next.js 16 application that's part of the Nx monorepo. Follow these steps to get it running.\n\n## Step 1: Install Dependencies\n\nFrom the project root, install all dependencies:\n\n```bash\npnpm install\n```\n\nThis will install dependencies for the entire monorepo, including canva-web.\n\n## Step 2: Configure Environment Variables\n\nCreate a `.env` file in the `apps/canva-web` directory:\n\n```bash\ncd apps/canva-web\ncp .env.example .env  # If example exists, or create new file\n```\n\nAdd the required environment variables (see [Environment Variables](environment-variables) for details).\n\n## Step 3: Start the Development Server\n\nFrom the project root:\n\n```bash\nnpx nx serve canva-web\n```\n\nOr use the Makefile shortcut:\n\n```bash\nmake web_up\n```\n\n## Step 4: Verify Installation\n\nOpen your browser and navigate to:\n\nhttp://localhost:3001\n\nYou should see the canva-web application running.\n\n## Building for Production\n\nTo build the application:\n\n```bash\nnpx nx build canva-web\n```\n\nOr:\n\n```bash\nmake build_web\n```\n\n## Common Commands\n\n- **Development**: `npx nx serve canva-web`\n- **Build**: `npx nx build canva-web`\n- **Lint**: `npx nx lint canva-web`\n- **Test**: `npx nx test canva-web`\n\n## Next Steps\n\n- Ensure [canva-admin](canva-admin-setup) is running for API access\n- Configure [environment variables](environment-variables)\n- Check [troubleshooting](troubleshooting) if issues occur",
    "updatedAt": "2025-01-20T10:00:00Z"
  },
  {
    "id": "4",
    "slug": "canva-admin-setup",
    "title": "Setting Up Admin",
    "category": "Setup",
    "description": "Step-by-step guide to set up the Strapi CMS backend (standalone application)",
    "content": "# Setting Up Canva-Admin\n\nCanva-Admin is a **standalone** Strapi 5.31.2 application (not part of the Nx monorepo). It uses React 18 and has its own package management.\n\n## Important: Standalone Application\n\nUnlike canva-web, canva-admin is **not** managed by Nx. It's a traditional Strapi application with its own:\n\n- `package.json`\n- `node_modules`\n- Build process\n- Configuration files\n\n## Step 1: Navigate to Canva-Admin Directory\n\n```bash\ncd apps/canva-admin\n```\n\n## Step 2: Install Dependencies\n\nUse npm (Strapi's recommended package manager):\n\n```bash\nnpm install\n```\n\n**Note**: Don't use pnpm here. Strapi works best with npm.\n\n## Step 3: Configure Environment Variables\n\nCreate a `.env` file in `apps/canva-admin`:\n\n```bash\n# In apps/canva-admin directory\ncp .env.example .env\n```\n\nAdd required environment variables (see [Environment Variables](environment-variables) for details).\n\n## Step 4: Set Up Database\n\n### Option A: Create Fresh Database (Recommended for New Setup)\n\nIf you're setting up a fresh database, follow these steps:\n\n1. **Create the database** using the Makefile:\n   ```bash\n   # From project root\n   make create_db DB_NAME=canva_admin_db\n   ```\n   \n   Or manually:\n   ```bash\n   createdb canva_admin_db\n   ```\n\n2. **Update your `.env` file** with database credentials:\n   ```env\n   DATABASE_NAME=canva_admin_db\n   DATABASE_USERNAME=your_db_user\n   DATABASE_PASSWORD=your_db_password\n   ```\n\n3. **Start Strapi** - it will create the schema automatically:\n   ```bash\n   make admin_up\n   ```\n\n### Option B: Restore from Production Dump (Recommended for Development)\n\nIf you have a production database dump and want to restore it locally:\n\n1. **Create the database**:\n   ```bash\n   # From project root\n   make create_db DB_NAME=canva_dev\n   ```\n\n2. **Restore the database dump** (without user data):\n   ```bash\n   # From project root\n   make restore_db_local DB_NAME=canva_dev\n   ```\n   \n   This will:\n   - Restore the database structure and data (excluding user data)\n   - Clean up orphaned foreign key references\n   - Prepare the database for default users\n\n3. **Create default users**:\n   ```bash\n   # From project root\n   make create_default_data DB_NAME=canva_dev\n   ```\n   \n   This creates:\n   - Regular user: `user@example.com` / `user123` (authenticated role)\n   - Admin user: `admin@example.com` / `admin123` (Super Admin role)\n\n4. **Update your `.env` file** to use the restored database:\n   ```env\n   DATABASE_NAME=canva_dev\n   DATABASE_USERNAME=your_db_user\n   DATABASE_PASSWORD=your_db_password\n   ```\n\n**Note**: The restore process may show some errors related to foreign key constraints - this is expected and will be automatically cleaned up.\n\n## Step 5: Build the Admin Panel\n\n**Important**: You must build the admin panel before running:\n\n```bash\nnpm run build\n```\n\nOr use the Makefile from project root:\n\n```bash\n# From project root\nmake build_admin\n```\n\n## Step 6: Start Strapi\n\n### Development Mode\n\n```bash\nnpm run develop\n```\n\nOr from project root:\n\n```bash\nmake admin_up\n```\n\n### Production Mode\n\n```bash\nnpm run start\n```\n\n## Step 7: Create Admin User\n\n### If Using Option A (Fresh Database)\n\nOn first run, Strapi will prompt you to create an admin user. Follow the on-screen instructions.\n\n### If Using Option B (Restored Database)\n\nDefault users are already created:\n\n- **Regular User**:\n  - Email: `user@example.com`\n  - Password: `user123`\n  - Role: Authenticated (for frontend login)\n\n- **Admin User** (Strapi Admin Panel):\n  - Email: `admin@example.com`\n  - Password: `admin123`\n  - Role: Super Admin\n\nYou can log in to the Strapi admin panel immediately at http://localhost:1337/admin using the admin credentials above.\n\n## Step 8: Verify Installation\n\nOpen your browser and navigate to:\n\nhttp://localhost:1337/admin\n\nYou should see the Strapi admin panel.\n\n## API Access\n\nThe Strapi API will be available at:\n\nhttp://localhost:1337/api\n\n## Important Notes\n\n- ✅ Always run `npm run build` after installing new plugins\n- ✅ Use `npm` not `pnpm` for canva-admin\n- ✅ Canva-admin runs independently from canva-web\n- ✅ Default port is 1337 (change in `.env` if needed)\n\n## Common Commands\n\n### Strapi Commands\n\n- **Development**: `npm run develop`\n- **Production**: `npm run start`\n- **Build**: `npm run build`\n- **Strapi CLI**: `npm run strapi`\n\n### Database Commands (from project root)\n\n- **Create database**: `make create_db DB_NAME=my_database`\n- **Restore database**: `make restore_db_local DB_NAME=my_database`\n- **Create default users**: `make create_default_data DB_NAME=my_database`\n- **Drop database**: `make drop_db DB_NAME=my_database`\n- **Recreate database**: `make recreate_db DB_NAME=my_database`\n\n**Note**: All database commands require `DB_NAME` parameter. Replace `my_database` with your actual database name.\n\n## Next Steps\n\n- Configure [environment variables](environment-variables)\n- Set up [canva-web](canva-web-setup) to connect to the API\n- Check [troubleshooting](troubleshooting) if issues occur",
    "updatedAt": "2025-01-20T10:00:00Z"
  },
  {
    "id": "5",
    "slug": "environment-variables",
    "title": "Environment Variables",
    "category": "Configuration",
    "description": "Complete guide to environment variables for both applications",
    "content": "# Environment Variables\n\nThis guide covers all environment variables needed for both applications.\n\n## Canva-Web Environment Variables\n\nCreate `.env` file in `apps/canva-web/`:\n\n### Required Variables\n\n```env\n# App Configuration\nNODE_ENV=development\nNEXT_PUBLIC_APP_URL=http://localhost:3001\nSECRET_COOKIE_PASSWORD=your-random-64-character-string-here\n\n# API Configuration\nAPI_URL=http://localhost:1337/api\n```\n\n### Optional Variables\n\n```env\n# OAuth Providers\nAUTH_GITHUB_ID=your-github-client-id\nAUTH_GITHUB_SECRET=your-github-client-secret\nAUTH_GOOGLE_ID=your-google-client-id\nAUTH_GOOGLE_SECRET=your-google-client-secret\nNEXT_PUBLIC_GOOGLE_ONE_TAP_CLIENT_ID=your-google-client-id\n\n# Localization\nNEXT_PUBLIC_DEFAULT_LOCALE=en\n```\n\n## Canva-Admin Environment Variables\n\nCreate `.env` file in `apps/canva-admin/`:\n\n### Required Variables\n\n```env\n# Server Configuration\nHOST=0.0.0.0\nPORT=1337\nNODE_ENV=development\n\n# Database (PostgreSQL)\nDATABASE_CLIENT=postgres\nDATABASE_HOST=localhost\nDATABASE_PORT=5432\nDATABASE_NAME=canva_admin_db\nDATABASE_USERNAME=your_db_user\nDATABASE_PASSWORD=your_db_password\nDATABASE_SSL=false\nDATABASE_SCHEMA=public\n\n# Security Keys (generate random strings)\nADMIN_JWT_SECRET=your-random-jwt-secret\nAPI_TOKEN_SALT=your-random-api-token-salt\nTRANSFER_TOKEN_SALT=your-random-transfer-token-salt\nAPP_KEYS=key1,key2,key3,key4\n```\n\n### Optional Variables\n\n```env\n# Email Configuration (Nodemailer with Gmail OAuth)\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=465\nSMTP_USERNAME=your-email@gmail.com\nGOOGLE_CLIENT_ID=your-google-client-id\nGOOGLE_CLIENT_SECRET=your-google-client-secret\nGOOGLE_REFRESH_TOKEN=your-google-refresh-token\nFROM_EMAIL=no-reply@yourdomain.com\nREPLY_EMAIL=support@yourdomain.com\n\n# Cloudinary (for file uploads)\nCLOUDINARY_NAME=your-cloudinary-name\nCLOUDINARY_KEY=your-cloudinary-api-key\nCLOUDINARY_SECRET=your-cloudinary-api-secret\n\n# Frontend URL (for webhooks, emails, etc.)\nFRONTEND_URL=http://localhost:3001\n\n## Generating Secure Secrets\n\n### Generate Random Strings\n\n**Linux/Mac**:\n```bash\n# 64-character string for SECRET_COOKIE_PASSWORD\nopenssl rand -hex 32\n\n# 32-character string for AUTH_SECRET\nopenssl rand -hex 16\n\n# JWT secrets\nopenssl rand -base64 32\n```\n\n**Windows (PowerShell)**:\n```powershell\n# 64-character string\n-join ((48..57) + (65..90) + (97..122) | Get-Random -Count 64 | % {[char]$_})\n```\n\n### Generate APP_KEYS\n\nGenerate 4 random keys separated by commas:\n```bash\nopenssl rand -base64 32\n# Run 4 times and join with commas\n```\n\n## Environment-Specific Files\n\nYou can create environment-specific files:\n\n- `.env.development`\n- `.env.production`\n- `.env.local` (git-ignored, for local overrides)\n\n## Security Best Practices\n\n- ✅ Never commit `.env` files to version control\n- ✅ Use different secrets for development and production\n- ✅ Rotate secrets regularly\n- ✅ Use strong, random strings for all secrets\n- ✅ Keep production secrets secure and encrypted\n\n## Verifying Configuration\n\n### Canva-Web\n\nCheck if environment variables are loaded:\n\n```bash\ncd apps/canva-web\nnode -e \"console.log(process.env.API_URL)\"\n```\n\n### Canva-Admin\n\nStrapi will show configuration errors on startup if required variables are missing.",
    "updatedAt": "2025-01-20T10:00:00Z"
  },
  {
    "id": "6",
    "slug": "troubleshooting",
    "title": "Troubleshooting",
    "category": "Configuration",
    "description": "Common issues and their solutions",
    "content": "# Troubleshooting\n\nCommon issues and solutions when setting up the Canva Clone project.\n\n## Installation Issues\n\n### Issue: pnpm install fails\n\n**Solution**:\n\n1. Clear pnpm cache:\n   ```bash\n   pnpm store prune\n   ```\n\n2. Delete `node_modules` and lock files:\n   ```bash\n   rm -rf node_modules pnpm-lock.yaml\n   rm -rf apps/*/node_modules\n   ```\n\n3. Reinstall:\n   ```bash\n   pnpm install\n   ```\n\n### Issue: Canva-admin npm install fails\n\n**Solution**:\n\n- Ensure you're using Node.js 20.x or lower (Strapi requirement)\n- Use `npm` not `pnpm` for canva-admin\n- Clear npm cache: `npm cache clean --force`\n\n## React Version Conflicts\n\n### Issue: React version mismatch warnings\n\n**Solution**:\n\nThis is **normal** and expected. See [React Version Mismatch](react-version-mismatch) for details.\n\n- Canva-web uses React 19 (required by Next.js 16)\n- Canva-admin uses React 18 (required by Strapi 5)\n- They run independently, so no conflicts occur\n\n## Database Issues\n\n### Issue: Database connection failed\n\n**Solution**:\n\n1. Verify PostgreSQL is running:\n   ```bash\n   # Linux/Mac\n   pg_isready\n   \n   # Or check service status\n   systemctl status postgresql\n   ```\n\n2. Check connection string format:\n   ```\n   postgresql://username:password@host:port/database\n   ```\n\n3. Verify credentials in `.env` file\n\n4. Test connection:\n   ```bash\n   psql -h localhost -U username -d database_name\n   ```\n\n### Issue: Migration errors\n\n**Solution**:\n\n1. Ensure database exists\n2. Check database user has proper permissions\n3. Verify `DATABASE_URL` is correct\n4. Try resetting database (backup first!):\n   ```bash\n   dropdb canva_web_db\n   createdb canva_web_db\n   ```\n\n## Port Conflicts\n\n### Issue: Port 3001 already in use\n\n**Solution**:\n\n1. Find process using port:\n   ```bash\n   # Linux/Mac\n   lsof -i :3001\n   \n   # Windows\n   netstat -ano | findstr :3001\n   ```\n\n2. Kill the process or change port in `.env`:\n   ```env\n   PORT=3001\n   ```\n\n### Issue: Port 1337 already in use\n\n**Solution**:\n\nChange Strapi port in `apps/canva-admin/.env`:\n```env\nPORT=1338\n```\n\nUpdate canva-web `API_URL` accordingly.\n\n## Strapi Issues\n\n### Issue: Strapi admin panel shows blank page\n\n**Solution**:\n\n1. Rebuild admin panel:\n   ```bash\n   cd apps/canva-admin\n   npm run build\n   ```\n\n2. Clear browser cache\n3. Check browser console for errors\n\n### Issue: Strapi won't start\n\n**Solution**:\n\n1. Check all required environment variables are set\n2. Verify database connection\n3. Check Strapi logs for specific errors\n4. Ensure `APP_KEYS` has exactly 4 comma-separated values\n\n### Issue: \"APP_KEYS required\" error\n\n**Solution**:\n\nGenerate 4 random keys:\n```bash\nopenssl rand -base64 32\n# Run 4 times, join with commas\n```\n\nAdd to `.env`:\n```env\nAPP_KEYS=key1,key2,key3,key4\n```\n\n## Next.js Issues\n\n### Issue: Next.js build fails\n\n**Solution**:\n\n1. Clear Next.js cache:\n   ```bash\n   rm -rf apps/canva-web/.next\n   ```\n\n2. Rebuild:\n   ```bash\n   npx nx build canva-web\n   ```\n\n### Issue: API routes not working\n\n**Solution**:\n\n1. Verify `API_URL` in `.env` points to Strapi\n2. Check Strapi is running on correct port\n3. Verify CORS settings in Strapi\n4. Check browser network tab for errors\n\n## Authentication Issues\n\n### Issue: Login not working\n\n**Solution**:\n\n1. Verify `AUTH_SECRET` is set in canva-web `.env`\n2. Check `SECRET_COOKIE_PASSWORD` is set\n3. Verify Strapi users-permissions plugin is enabled\n4. Check API connection to Strapi\n\n### Issue: OAuth providers not working\n\n**Solution**:\n\n1. Verify client IDs and secrets are correct\n2. Check redirect URIs match exactly\n3. Ensure OAuth apps are configured in provider dashboard\n4. Check browser console for OAuth errors\n\n## Performance Issues\n\n### Issue: Slow development server\n\n**Solution**:\n\n1. Reduce number of files watched (if using WSL)\n2. Increase Node.js memory:\n   ```bash\n   NODE_OPTIONS=\"--max-old-space-size=4096\" npx nx serve canva-web\n   ```\n\n3. Use production build for testing:\n   ```bash\n   npx nx build canva-web --prod\n   npx nx start canva-web\n   ```\n\n## Getting Help\n\nIf you're still experiencing issues:\n\n1. Check application logs for detailed error messages\n2. Verify all environment variables are set correctly\n3. Ensure all prerequisites are installed and up to date\n4. Review the [Getting Started](getting-started) guide\n5. Check GitHub issues or documentation\n\n## Common Error Messages\n\n### \"Module not found\"\n\n- Run `pnpm install` from project root\n- For canva-admin, run `npm install` in `apps/canva-admin`\n\n### \"EADDRINUSE\"\n\n- Port is already in use (see Port Conflicts above)\n\n### \"ECONNREFUSED\"\n\n- Database or API server is not running\n- Check connection string and server status\n\n### \"Invalid API Token\"\n\n- Regenerate API token in Strapi admin\n- Update `API_URL` if needed",
    "updatedAt": "2025-01-20T10:00:00Z"
  },
  {
    "id": "7",
    "slug": "project-structure",
    "title": "Project Structure",
    "category": "Introduction",
    "description": "Understanding the monorepo structure and application separation",
    "content": "# Project Structure\n\nUnderstanding how the Canva Clone project is organized.\n\n## Overview\n\nThis is an **Nx monorepo** containing multiple applications and libraries, with one standalone application.\n\n## Root Directory Structure\n\n```\ncanva-clone/\n├── apps/                    # Applications\n│   ├── canva-web/          # Next.js frontend (Nx monorepo app)\n│   ├── canva-admin/        # Strapi backend (STANDALONE)\n│   ├── canva-web-e2e/      # E2E tests\n│   ├── i18n/               # Internationalization library\n│   └── mock-api/           # Mock API server\n├── libs/                    # Shared libraries\n│   └── canva-editor/       # Editor component library\n├── package.json            # Root package.json (monorepo config)\n├── pnpm-workspace.yaml     # pnpm workspace configuration\n├── nx.json                 # Nx configuration\n└── tsconfig.base.json      # TypeScript base config\n```\n\n## Applications\n\n### Canva-Web (Monorepo App)\n\n**Location**: `apps/canva-web/`\n\n- **Type**: Next.js 16 application\n- **Managed by**: Nx monorepo\n- **Package Manager**: pnpm (via workspace)\n- **React Version**: 19.2.0\n- **Port**: 3001 (default)\n\n**Key Files**:\n- `package.json` - Dependencies (managed by root)\n- `next.config.ts` - Next.js configuration\n- `src/` - Application source code\n\n### Canva-Admin (Standalone App)\n\n**Location**: `apps/canva-admin/`\n\n- **Type**: Strapi 5.31.2 application\n- **Managed by**: Standalone (NOT part of Nx monorepo)\n- **Package Manager**: npm (separate from monorepo)\n- **React Version**: 18.3.1\n- **Port**: 1337 (default)\n\n**Key Files**:\n- `package.json` - Own dependencies (npm)\n- `config/` - Strapi configuration files\n- `src/` - Strapi source code\n- `database/` - Database migrations\n\n**Important**: Canva-admin has its own `node_modules` and is managed independently.\n\n## Libraries\n\n### Canva-Editor\n\n**Location**: `libs/canva-editor/`\n\n- Shared editor component library\n- Used by canva-web\n- Built with Vite\n\n## Key Differences\n\n### Monorepo Apps (canva-web)\n\n- ✅ Managed by Nx\n- ✅ Use pnpm workspace\n- ✅ Share dependencies from root\n- ✅ Can use Nx commands: `npx nx serve canva-web`\n\n### Standalone App (canva-admin)\n\n- ❌ NOT managed by Nx\n- ❌ Uses npm independently\n- ❌ Has own `node_modules`\n- ❌ Use npm commands: `npm run develop`\n\n## Running Applications\n\n### Monorepo Apps\n\n```bash\n# From project root\nnpx nx serve canva-web\nnpx nx build canva-web\n```\n\n### Standalone App\n\n```bash\n# Must cd into directory\ncd apps/canva-admin\nnpm run develop\nnpm run build\n```\n\n## Dependencies Management\n\n### Installing for Monorepo Apps\n\n```bash\n# From project root\npnpm add package-name --filter canva-web\n```\n\n### Installing for Standalone App\n\n```bash\ncd apps/canva-admin\nnpm install package-name\n```\n\n## Configuration Files\n\n### Root Level\n\n- `package.json` - Monorepo dependencies and scripts\n- `pnpm-workspace.yaml` - Workspace configuration\n- `nx.json` - Nx configuration\n- `tsconfig.base.json` - Shared TypeScript config\n\n### App Level\n\nEach app has its own:\n- `package.json`\n- `.env` (environment variables)\n- Configuration files specific to the framework\n\n## Build Outputs\n\n### Monorepo Apps\n\nBuild outputs go to `dist/apps/canva-web/`\n\n### Standalone App\n\nBuild output goes to `apps/canva-admin/dist/`\n\n## Understanding the Separation\n\nWhy is canva-admin standalone?\n\n1. **Strapi Requirements**: Strapi has specific build and dependency requirements\n2. **Package Manager**: Strapi works best with npm, not pnpm\n3. **Isolation**: Keeps Strapi's complex setup separate from monorepo\n4. **Flexibility**: Can be deployed independently\n\nThis separation is intentional and beneficial for maintenance.",
    "updatedAt": "2025-01-20T10:00:00Z"
  },
  {
    "id": "8",
    "slug": "deploy-admin-railway",
    "title": "Deploying Admin on Railway",
    "category": "Deployment",
    "description": "Complete guide to deploy Strapi backend on Railway with PostgreSQL database",
    "content": "# Deploying Admin on Railway\n\nThis guide will walk you through deploying the canva-admin (Strapi) backend on Railway.com with a PostgreSQL database.\n\n## Prerequisites\n\n- Railway account (sign up at [railway.app](https://railway.app))\n- GitHub account (to connect your repository)\n- Git installed on your local machine\n- Project code ready to deploy\n\n## Step 0: Push Project to GitHub\n\n**Important**: Before deploying, you must push your project to a GitHub repository. Railway connects to your GitHub repo to deploy the code.\n\n### If You Don't Have a GitHub Repository Yet\n\n1. Create a new repository on GitHub:\n   - Go to [GitHub](https://github.com)\n   - Click **\"+\"** → **\"New repository\"**\n   - Name it (e.g., `canva-clone`)\n   - Choose **Public** or **Private**\n   - **Don't** initialize with README, .gitignore, or license (if you already have code)\n   - Click **\"Create repository\"**\n\n2. Initialize Git in your project (if not already done):\n   ```bash\n   cd canva-clone\n   git init\n   ```\n\n3. Add all files and commit:\n   ```bash\n   git add .\n   git commit -m \"Initial commit\"\n   ```\n\n4. Connect to GitHub and push:\n   ```bash\n   git remote add origin https://github.com/your-username/canva-clone.git\n   git branch -M main\n   git push -u origin main\n   ```\n\n### If You Already Have a GitHub Repository\n\n1. Make sure all your changes are committed:\n   ```bash\n   git add .\n   git commit -m \"Prepare for deployment\"\n   ```\n\n2. Push to GitHub:\n   ```bash\n   git push origin main\n   ```\n\n**Note**: Ensure your `.env` files are in `.gitignore` and never commit sensitive information like API keys or passwords.\n\n## Step 1: Create PostgreSQL Database\n\n1. Log in to [Railway Dashboard](https://railway.app/dashboard)\n2. Click **\"New Project\"**\n3. Select **\"Empty Project\"**\n4. Click **\"+ New\"** → **\"Database\"** → **\"Add PostgreSQL\"**\n5. Railway will automatically provision a PostgreSQL database\n6. Click on the PostgreSQL service\n7. Go to the **\"Variables\"** tab\n8. Copy the following connection variables (you'll need them later):\n   - `PGHOST`\n   - `PGPORT`\n   - `PGDATABASE`\n   - `PGUSER`\n   - `PGPASSWORD`\n\n**Note**: Railway also provides a `DATABASE_URL` connection string that you can use directly.\n\n## Step 2: Deploy Strapi Application\n\n1. In the same Railway project, click **\"+ New\"** → **\"GitHub Repo\"**\n2. Select your repository (canva-clone)\n3. Railway will detect the project structure\n\n## Step 3: Configure Service Settings\n\n1. Click on your newly created service\n2. Go to **\"Settings\"** tab\n3. Configure the following:\n\n### Root Directory\nSet the root directory to: `apps/canva-admin`\n\n### Build Command\n```bash\nnpm install && npm run build\n```\n\n### Start Command\n```bash\nnpm run start\n```\n\n### Node Version\nSet to: `20.x` (Railway will auto-detect from `railway.toml` or `nixpacks.toml`)\n\n## Step 4: Connect Database to Service\n\n1. In your Strapi service, go to **\"Variables\"** tab\n2. Click **\"+ New Variable\"** → **\"Reference\"**\n3. Select your PostgreSQL service\n4. Add the following variable references:\n   - Variable: `DATABASE_HOST` → Reference: `PGHOST`\n   - Variable: `DATABASE_PORT` → Reference: `PGPORT`\n   - Variable: `DATABASE_NAME` → Reference: `PGDATABASE`\n   - Variable: `DATABASE_USERNAME` → Reference: `PGUSER`\n   - Variable: `DATABASE_PASSWORD` → Reference: `PGPASSWORD`\n\n**Alternative**: You can use the `DATABASE_URL` directly:\n- Variable: `DATABASE_URL` → Reference: `DATABASE_URL`\n\n## Step 5: Configure Environment Variables\n\nAdd the following environment variables in the **\"Variables\"** tab:\n\n### Required Variables\n\n```env\n# Server Configuration\nHOST=0.0.0.0\nPORT=${{PORT}}\nNODE_ENV=production\n\n# Database Configuration (if using individual variables)\nDATABASE_CLIENT=postgres\nDATABASE_SSL=true\nDATABASE_SCHEMA=public\n\n# Or use DATABASE_URL (recommended)\n# DATABASE_URL=${{Postgres.DATABASE_URL}}\n\n# Security Keys (generate random strings)\nADMIN_JWT_SECRET=<generate-random-64-char-string>\nAPI_TOKEN_SALT=<generate-random-64-char-string>\nTRANSFER_TOKEN_SALT=<generate-random-64-char-string>\nAPP_KEYS=<key1,key2,key3,key4>\n```\n\n### Generating Security Keys\n\nUse these commands to generate secure keys:\n\n```bash\n# Generate ADMIN_JWT_SECRET\nopenssl rand -base64 64\n\n# Generate API_TOKEN_SALT\nopenssl rand -base64 64\n\n# Generate TRANSFER_TOKEN_SALT\nopenssl rand -base64 64\n\n# Generate APP_KEYS (run 4 times, join with commas)\nopenssl rand -base64 32\n```\n\n### Optional Variables\n\n```env\n# Frontend URL (for CORS, webhooks, emails)\nFRONTEND_URL=https://your-vercel-app.vercel.app\n\n# Email Configuration\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=465\nSMTP_USERNAME=your-email@gmail.com\nGOOGLE_CLIENT_ID=your-google-client-id\nGOOGLE_CLIENT_SECRET=your-google-client-secret\nGOOGLE_REFRESH_TOKEN=your-google-refresh-token\nFROM_EMAIL=no-reply@yourdomain.com\nREPLY_EMAIL=support@yourdomain.com\n\n# Cloudinary (for file uploads)\nCLOUDINARY_NAME=your-cloudinary-name\nCLOUDINARY_KEY=your-cloudinary-api-key\nCLOUDINARY_SECRET=your-cloudinary-api-secret```\n\n## Step 6: Deploy\n\n1. Railway will automatically start building and deploying\n2. Monitor the build logs in the **\"Deployments\"** tab\n3. Wait for the deployment to complete\n\n## Step 7: Create Admin User\n\n1. Once deployed, Railway will provide a public URL (e.g., `https://your-app.up.railway.app`)\n2. Visit `https://your-app.up.railway.app/admin`\n3. You'll be prompted to create the first admin user\n4. Fill in the registration form and create your account\n\n## Step 8: Configure CORS (Important)\n\nTo allow your Vercel frontend to access the API:\n\n1. In Railway, go to your Strapi service → **\"Variables\"**\n2. Add:\n   ```env\n   ALLOWED_ORIGINS=https://your-vercel-app.vercel.app,http://localhost:3001\n   ```\n\nOr configure in Strapi's `config/middlewares.ts`:\n\n```typescript\nexport default [\n  'strapi::logger',\n  'strapi::errors',\n  {\n    name: 'strapi::security',\n    config: {\n      contentSecurityPolicy: {\n        useDefaults: true,\n        directives: {\n          'connect-src': [\"'self'\", 'https:'],\n          'img-src': [\"'self'\", 'data:', 'blob:', 'res.cloudinary.com'],\n          'media-src': [\"'self'\", 'data:', 'blob:', 'res.cloudinary.com'],\n        },\n      },\n    },\n  },\n  {\n    name: 'strapi::cors',\n    config: {\n      origin: process.env.ALLOWED_ORIGINS?.split(',') || ['http://localhost:3001'],\n      credentials: true,\n    },\n  },\n  'strapi::poweredBy',\n  'strapi::query',\n  'strapi::body',\n  'strapi::session',\n  'strapi::favicon',\n  'strapi::public',\n];\n```\n\n## Step 9: Get API URL\n\n1. Your Strapi API will be available at: `https://your-app.up.railway.app/api`\n2. Copy this URL - you'll need it for your Vercel deployment\n3. Test the API: `https://your-app.up.railway.app/api/users-permissions/roles`\n\n## Step 10: Custom Domain (Optional)\n\n1. Go to your service → **\"Settings\"** → **\"Networking\"**\n2. Click **\"Generate Domain\"** or **\"Custom Domain\"**\n3. Follow Railway's instructions to configure DNS\n4. Update `FRONTEND_URL` and CORS settings with your custom domain\n\n## Troubleshooting\n\n### Build Fails\n\n- Check build logs in Railway dashboard\n- Ensure `apps/canva-admin` is the correct root directory\n- Verify Node.js version is 20.x\n- Check that `package.json` has correct build scripts\n\n### Database Connection Issues\n\n- Verify all database variables are correctly referenced\n- Check that PostgreSQL service is running\n- Ensure `DATABASE_SSL=true` for Railway's PostgreSQL\n- Test connection using Railway's database query tool\n\n### Admin Panel Shows Blank Page\n\n- Check deployment logs for errors\n- Verify `APP_KEYS` has exactly 4 comma-separated values\n- Ensure build completed successfully\n- Clear browser cache and try again\n\n### CORS Errors\n\n- Verify `ALLOWED_ORIGINS` includes your Vercel URL\n- Check middleware configuration\n- Ensure credentials are enabled in CORS config\n\n### Port Issues\n\n- Railway automatically sets `$PORT` environment variable\n- Ensure your Strapi config uses `env('PORT', 1337)`\n- Don't hardcode port numbers\n\n## Production Checklist\n\n- [ ] PostgreSQL database is provisioned\n- [ ] All environment variables are set\n- [ ] Security keys are generated and set\n- [ ] Build completes successfully\n- [ ] Admin user is created\n- [ ] API is accessible at `/api` endpoint\n- [ ] CORS is configured for frontend domain\n- [ ] Custom domain is configured (if applicable)\n- [ ] Email service is configured (if needed)\n- [ ] Cloudinary is configured (if using file uploads)\n\n## Next Steps\n\nAfter deploying canva-admin:\n\n1. Note your Railway API URL (e.g., `https://your-app.up.railway.app/api`)\n2. Proceed to [Deploy Canva-Web on Vercel](deploy-web-vercel)\n3. Use the Railway API URL in your Vercel environment variables",
    "updatedAt": "2025-01-20T10:00:00Z"
  },
  {
    "id": "9",
    "slug": "deploy-web-vercel",
    "title": "Deploying Web on Vercel",
    "category": "Deployment",
    "description": "Complete guide to deploy Next.js frontend on Vercel",
    "content": "# Deploying Web on Vercel\n\nThis guide will walk you through deploying the canva-web (Next.js) frontend on Vercel.\n\n## Prerequisites\n\n- Vercel account (sign up at [vercel.com](https://vercel.com))\n- GitHub account (to connect your repository)\n- Git installed on your local machine\n- Railway Strapi backend deployed (see [Deploy Admin on Railway](deploy-admin-railway))\n- PostgreSQL database (Neon, Vercel Postgres, or Railway)\n\n## Step 0: Push Project to GitHub\n\n**Important**: Before deploying, you must push your project to a GitHub repository. Vercel connects to your GitHub repo to deploy the code.\n\n### If You Don't Have a GitHub Repository Yet\n\n1. Create a new repository on GitHub:\n   - Go to [GitHub](https://github.com)\n   - Click **\"+\"** → **\"New repository\"**\n   - Name it (e.g., `canva-clone`)\n   - Choose **Public** or **Private**\n   - **Don't** initialize with README, .gitignore, or license (if you already have code)\n   - Click **\"Create repository\"**\n\n2. Initialize Git in your project (if not already done):\n   ```bash\n   cd canva-clone\n   git init\n   ```\n\n3. Add all files and commit:\n   ```bash\n   git add .\n   git commit -m \"Initial commit\"\n   ```\n\n4. Connect to GitHub and push:\n   ```bash\n   git remote add origin https://github.com/your-username/canva-clone.git\n   git branch -M main\n   git push -u origin main\n   ```\n\n### If You Already Have a GitHub Repository\n\n1. Make sure all your changes are committed:\n   ```bash\n   git add .\n   git commit -m \"Prepare for deployment\"\n   ```\n\n2. Push to GitHub:\n   ```bash\n   git push origin main\n   ```\n\n**Note**: Ensure your `.env` files are in `.gitignore` and never commit sensitive information like API keys or passwords.\n\n## Step 1: Connect Repository to Vercel\n\n1. Log in to [Vercel Dashboard](https://vercel.com/dashboard)\n2. Click **\"Add New Project\"**\n3. Import your GitHub repository\n4. Select the `canva-clone` repository\n5. Click **\"Import\"**\n\n## Step 2: Configure Project Settings\n\n### Root Directory\n\nSet the root directory to: `apps/canva-web`\n\n### Framework Preset\n\nVercel should auto-detect Next.js. If not, select:\n- **Framework Preset**: Next.js\n\n### Build Settings\n\nConfigure the following:\n\n- **Build Command**: `cd ../.. && pnpm install && npx nx build canva-web --prod`\n  \n  Or if using npm:\n  ```bash\n  cd ../.. && npm install && npx nx build canva-web --prod\n  ```\n\n- **Output Directory**: `../../dist/apps/canva-web/.next`\n\n- **Install Command**: `cd ../.. && pnpm install` (or `npm install`)\n\n- **Root Directory**: `apps/canva-web`\n\n**Note**: Since canva-web is in a monorepo, you need to build from the root directory.\n\n## Step 3: Set Up PostgreSQL Database (Optional)\n\nIf you need a separate database for canva-web:\n\n1. In Vercel project, go to **\"Storage\"** tab\n2. Click **\"Create Database\"** → **\"Postgres\"**\n3. Follow the setup wizard\n4. Copy the connection string\n\n**Alternative**: Use [Neon](https://neon.tech) or keep using Railway PostgreSQL.\n\n## Step 4: Configure Environment Variables\n\nGo to **\"Settings\"** → **\"Environment Variables\"** and add:\n\n### Required Variables\n\n```env\n# App Configuration\nNODE_ENV=production\nNEXT_PUBLIC_APP_URL=https://your-app.vercel.app\nSECRET_COOKIE_PASSWORD=<generate-random-64-char-string>\n\n# API Configuration (from Railway)\nAPI_URL=https://your-railway-app.up.railway.app/api\n\n# Database (PostgreSQL)\nDATABASE_URL=postgresql://user:password@host:port/database\n```\n\n### Generating Secrets\n\nUse these commands to generate secure random strings:\n\n```bash\n# For SECRET_COOKIE_PASSWORD (64 chars)\nnode -e \"console.log(require('crypto').randomBytes(64).toString('base64'))\"\n\n# For AUTH_SECRET (32 chars)\nnode -e \"console.log(require('crypto').randomBytes(32).toString('base64'))\"\n```\n\n### Authentication Variables\n\n```env\n# Authentication\nAUTH_SECRET=<generate-random-32-char-string>\n```\n\n### Optional Variables\n\n```env\n# OAuth Providers (GitHub)\nAUTH_GITHUB_ID=your-github-client-id\nAUTH_GITHUB_SECRET=your-github-client-secret\n\n# OAuth Providers (Google)\nAUTH_GOOGLE_ID=your-google-client-id\nAUTH_GOOGLE_SECRET=your-google-client-secret\nNEXT_PUBLIC_GOOGLE_ONE_TAP_CLIENT_ID=your-google-client-id\n\n# Localization\nNEXT_PUBLIC_DEFAULT_LOCALE=en\n```\n\n## Step 5: Configure OAuth Providers\n\n### GitHub OAuth\n\n1. Go to [GitHub Developer Settings](https://github.com/settings/developers)\n2. Click **\"New OAuth App\"**\n3. Fill in:\n   - **Application name**: Canva Clone\n   - **Homepage URL**: `https://your-app.vercel.app`\n   - **Authorization callback URL**: `https://your-app.vercel.app/api/auth/callback/github`\n4. Copy **Client ID** and **Client Secret**\n5. Add to Vercel environment variables\n\n### Google OAuth\n\n1. Go to [Google Cloud Console](https://console.cloud.google.com/apis/credentials)\n2. Create **OAuth 2.0 Client ID**\n3. Add authorized redirect URIs:\n   - `https://your-app.vercel.app/api/auth/callback/google`\n4. Copy **Client ID** and **Client Secret**\n5. Add to Vercel environment variables\n\n## Step 6: Deploy\n\n1. Click **\"Deploy\"**\n2. Vercel will build and deploy your application\n3. Monitor the build logs\n4. Wait for deployment to complete\n\n## Step 7: Verify Deployment\n\n1. Once deployed, Vercel will provide a URL: `https://your-app.vercel.app`\n2. Visit the URL in your browser\n3. Test the application functionality\n4. Check that API calls to Railway backend are working\n\n## Step 8: Update Railway CORS Settings\n\nAfter getting your Vercel URL, update Railway CORS:\n\n1. Go to Railway dashboard → Your Strapi service\n2. **\"Variables\"** tab\n3. Update `ALLOWED_ORIGINS`:\n   ```env\n   ALLOWED_ORIGINS=https://your-app.vercel.app,https://your-app.vercel.app\n   ```\n4. Redeploy Strapi service (or it will auto-redeploy)\n\n## Step 9: Custom Domain (Optional)\n\n1. Go to **\"Settings\"** → **\"Domains\"**\n2. Add your custom domain\n3. Follow Vercel's DNS configuration instructions\n4. Update environment variables:\n   - `NEXT_PUBLIC_APP_URL` → Your custom domain\n5. Update OAuth callback URLs with new domain\n6. Update Railway `ALLOWED_ORIGINS` with new domain\n\n## Troubleshooting\n\n### Build Fails with \"Cannot find module 'canva-editor'\"\n\n**Solution**:\n\n1. Ensure build command runs from project root\n2. Check that `canva-editor` library is built:\n   ```bash\n   cd libs/canva-editor && npm run build\n   ```\n3. Verify `next.config.ts` includes:\n   ```typescript\n   transpilePackages: ['canva-editor']\n   ```\n\n### Build Fails with Nx Errors\n\n**Solution**:\n\n1. Ensure build command includes `pnpm install` or `npm install`\n2. Check that you're building from project root\n3. Verify `nx.json` configuration is correct\n4. Try clearing Vercel build cache\n\n### Database Connection Issues\n\n**Solution**:\n\n1. Verify `DATABASE_URL` is correct\n2. Ensure database allows connections from Vercel IPs\n3. For Neon, enable connection pooling\n4. Check database credentials\n\n### API Connection Issues (CORS)\n\n**Solution**:\n\n1. Verify `API_URL` points to your Railway Strapi backend\n2. Check Railway CORS settings include your Vercel domain\n3. Ensure `ALLOWED_ORIGINS` in Railway is set correctly\n4. Check browser console for CORS errors\n\n### Authentication Not Working\n\n**Solution**:\n\n1. Verify `AUTH_SECRET` is set\n2. Check `SECRET_COOKIE_PASSWORD` is set\n3. Ensure OAuth callback URLs match exactly\n4. Verify OAuth client IDs and secrets are correct\n5. Check that `NEXT_PUBLIC_APP_URL` matches deployment URL\n\n### Environment Variables Not Loading\n\n**Solution**:\n\n1. Ensure variables are set for **Production** environment\n2. Redeploy after adding new variables\n3. Check variable names match exactly (case-sensitive)\n4. Verify no typos in variable names\n\n### 404 Errors on Routes\n\n**Solution**:\n\n1. Check Next.js routing configuration\n2. Verify `next.config.ts` is correct\n3. Ensure all pages are in correct directory structure\n4. Check Vercel build logs for routing issues\n\n## Production Checklist\n\n- [ ] Repository is connected to Vercel\n- [ ] Root directory is set to `apps/canva-web`\n- [ ] Build settings are configured correctly\n- [ ] All required environment variables are set\n- [ ] Database is provisioned and connected\n- [ ] Railway Strapi backend is deployed\n- [ ] `API_URL` points to Railway backend\n- [ ] OAuth providers are configured\n- [ ] CORS is configured in Railway\n- [ ] Application is accessible and functional\n- [ ] Custom domain is configured (if applicable)\n- [ ] SSL certificate is active\n- [ ] All authentication flows work\n- [ ] API connectivity is verified\n\n## Performance Optimization\n\n### Enable Vercel Analytics\n\n1. Go to **\"Analytics\"** tab\n2. Enable **\"Web Analytics\"**\n3. Monitor performance metrics\n\n### Configure Edge Functions\n\nIf using Next.js Edge Runtime, ensure proper configuration in `next.config.ts`.\n\n### Image Optimization\n\nVercel automatically optimizes Next.js images. Ensure `next/image` is used throughout the app.\n\n## Monitoring\n\n1. **Deployments**: Monitor in **\"Deployments\"** tab\n2. **Logs**: Check **\"Logs\"** tab for runtime errors\n3. **Analytics**: Use **\"Analytics\"** for performance monitoring\n4. **Speed Insights**: Enable **\"Speed Insights\"** for performance tracking\n\n## Next Steps\n\nAfter successful deployment:\n\n1. Test all application features\n2. Monitor error logs\n3. Set up error tracking (Sentry, etc.)\n4. Configure backup strategies\n5. Set up monitoring and alerts\n6. Review [Troubleshooting](troubleshooting) guide for common issues",
    "updatedAt": "2025-01-20T10:00:00Z"
  }
]
